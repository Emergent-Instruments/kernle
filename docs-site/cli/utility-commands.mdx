---
title: Utility Commands
description: "Commands for loading, searching, exporting, and maintaining memory"
---

# Utility Commands

Commands for managing memory state, searching, analysis, and maintenance.

## load

Load and display working memory at session start. Uses priority-based budget allocation to fit the most important memories within token limits.

```bash
kernle -s <stack> load [--json] [--sync] [--no-sync] [--budget TOKENS] [--no-truncate]
```

| Option | Description |
|--------|-------------|
| `-j, --json` | Output as JSON (includes `_meta` with budget metrics) |
| `-s, --sync` | Force sync (pull) before loading |
| `--no-sync` | Skip sync even if auto-sync enabled |
| `-b, --budget TOKENS` | Token budget for memory loading (100-50000, default: 8000) |
| `--no-truncate` | Disable content truncation (may exceed budget) |

<Tip>
Use `--budget` to prevent context overflow. A budget of 6000-8000 tokens is recommended for most sessions. See [Context Overload Recovery](/troubleshooting/context-overload) for details.
</Tip>

### Priority Ordering

Memories are loaded by priority until the budget is exhausted:

| Priority | Memory Type | Sorting |
|----------|-------------|---------|
| 1.00 | Checkpoint | Always loaded first |
| 0.90 | Values | By priority (descending) |
| 0.70 | Beliefs | By confidence (descending) |
| 0.65 | Goals | By recency |
| 0.60 | Drives | By intensity (descending) |
| 0.40 | Episodes | By recency |
| 0.35 | Notes | By recency |
| 0.30 | Relationships | By last interaction |

### Budget Metadata (`_meta`)

When using `--json`, the response includes a `_meta` object with budget metrics:

```json
{
  "_meta": {
    "budget_used": 5200,
    "budget_total": 8000,
    "excluded_count": 12
  }
}
```

| Field | Description |
|-------|-------------|
| `budget_used` | Tokens consumed by loaded memories |
| `budget_total` | Original budget requested |
| `excluded_count` | Number of memories that could not fit |

### Token Estimation

Tokens are estimated at approximately 4 characters per token, with a 1.3x safety margin for JSON serialization overhead.

### Access Tracking

Loading memories automatically records access for salience-based forgetting. Frequently accessed memories maintain higher salience and are less likely to be forgotten.

```bash
# Standard load
kernle -s claire load

# Force sync from cloud first
kernle -s claire load --sync

# Load with token budget (recommended)
kernle -s claire load --budget 6000

# Get JSON with budget metrics
kernle -s claire load --json --budget 8000
```

---

## checkpoint

Save and restore session state.

### checkpoint save

```bash
kernle -s <stack> checkpoint save TASK [options]
```

| Option | Description |
|--------|-------------|
| `-p, --pending PENDING` | Pending item (repeatable) |
| `-c, --context CONTEXT` | Additional context |
| `--progress PROGRESS` | Current progress on the task |
| `-n, --next NEXT` | Immediate next step |
| `-b, --blocker BLOCKER` | Current blocker if any |
| `-s, --sync` | Force sync after saving |
| `--no-sync` | Skip sync |

<Tip>
Use `--progress`, `--next`, and `--blocker` for better context recovery. These structured fields help your SI resume work more effectively.
</Tip>

<Tabs>
  <Tab title="Basic">
    ```bash
    kernle -s claire checkpoint save "Working on user authentication"
    ```
  </Tab>
  <Tab title="With Pending Items">
    ```bash
    kernle -s claire checkpoint save "Refactoring database layer" \
      --pending "finish migration script" \
      --pending "update tests"
    ```
  </Tab>
  <Tab title="With Context">
    ```bash
    kernle -s claire checkpoint save "Debugging API issue" \
      --context "Error occurs when token expires after 1 hour"
    ```
  </Tab>
</Tabs>

### checkpoint load

```bash
kernle -s <stack> checkpoint load [--json]
```

### checkpoint clear

```bash
kernle -s <stack> checkpoint clear
```

---

## search

Search memory using vector similarity.

```bash
kernle -s <stack> search QUERY [--limit LIMIT]
```

| Option | Description |
|--------|-------------|
| `-l, --limit LIMIT` | Maximum results (default: 10) |

```bash
kernle -s claire search "authentication"
kernle -s claire search "database performance" --limit 5
```

---

## status

Show memory status overview.

```bash
kernle -s <stack> status
```

**Example output:**
```
Memory Status for claire
========================================
Values:     3
Beliefs:    12
Goals:      2 active
Episodes:   45
Raw:        8 (5 unprocessed)
Notes:      23
Checkpoint: Yes (2 hours ago)
```

---

## when

Query memories by time period.

```bash
kernle -s <stack> when [PERIOD]
```

| Period | Description |
|--------|-------------|
| `today` | Today's memories (default) |
| `yesterday` | Yesterday's memories |
| `this week` | This week's memories |
| `last hour` | Last hour's memories |

```bash
kernle -s claire when yesterday
kernle -s claire when "this week"
```

---

## anxiety

Memory anxiety tracking and management.

```bash
kernle -s <stack> anxiety [options]
```

| Option | Description |
|--------|-------------|
| `-d, --detailed` | Show detailed breakdown |
| `-a, --actions` | Show recommended actions |
| `--auto` | Execute recommended actions |
| `-c, --context TOKENS` | Current context token usage |
| `-l, --limit LIMIT` | Context window limit (default: 200000) |
| `-e, --emergency` | Run emergency save immediately |
| `-s, --summary` | Summary for emergency save |
| `-j, --json` | Output as JSON |

<Tabs>
  <Tab title="Quick Check">
    ```bash
    kernle -s claire anxiety
    # Output: Memory Anxiety: 45/100 (Aware)
    ```
  </Tab>
  <Tab title="Detailed">
    ```bash
    kernle -s claire anxiety --detailed --actions
    ```
  </Tab>
  <Tab title="Auto-Fix">
    ```bash
    kernle -s claire anxiety --auto
    ```
  </Tab>
  <Tab title="Emergency">
    ```bash
    kernle -s claire anxiety --emergency --summary "Context compaction triggered"
    ```
  </Tab>
</Tabs>

---

## identity

Identity synthesis operations.

### identity show

Generate a coherent identity narrative.

```bash
kernle -s <stack> identity show [--json]
# or just:
kernle -s <stack> identity
```

### identity confidence

Check identity coherence score.

```bash
kernle -s <stack> identity confidence [--json]
```

### identity drift

Detect identity drift over time.

```bash
kernle -s <stack> identity drift [--days DAYS] [--json]
```

| Option | Description |
|--------|-------------|
| `-d, --days DAYS` | Days to look back (default: 30) |

---

## emotion

Emotional memory operations.

### emotion summary

```bash
kernle -s <stack> emotion summary [--days DAYS] [--json]
```

### emotion search

Search by emotional characteristics.

```bash
kernle -s <stack> emotion search [options]
```

| Option | Description |
|--------|-------------|
| `--positive` | Find positive episodes |
| `--negative` | Find negative episodes |
| `--calm` | Find low-arousal episodes |
| `--intense` | Find high-arousal episodes |
| `-t, --tag TAG` | Emotion tag to match |
| `-l, --limit LIMIT` | Maximum results (default: 10) |

```bash
kernle -s claire emotion search --positive --limit 5
kernle -s claire emotion search --negative --intense
```

### emotion tag

Add emotional tags to an episode.

```bash
kernle -s <stack> emotion tag EPISODE_ID [--valence V] [--arousal A] [--tag TAG]...
```

### emotion mood

Get mood-relevant memories.

```bash
kernle -s <stack> emotion mood --valence V --arousal A [--limit LIMIT]
```

---

## meta

Meta-memory operations.

### meta confidence

Get confidence for a memory.

```bash
kernle -s <stack> meta confidence TYPE ID
```

### meta verify

Verify a memory (increases confidence).

```bash
kernle -s <stack> meta verify TYPE ID [--evidence EVIDENCE]
```

### meta lineage

Get provenance chain.

```bash
kernle -s <stack> meta lineage TYPE ID [--json]
```

### meta uncertain

List low-confidence memories.

```bash
kernle -s <stack> meta uncertain [--threshold T] [--limit L]
```

### meta knowledge

Show knowledge map.

```bash
kernle -s <stack> meta knowledge [--json]
```

### meta gaps

Detect knowledge gaps.

```bash
kernle -s <stack> meta gaps QUERY [--json]
```

### meta boundaries

Show competence boundaries.

```bash
kernle -s <stack> meta boundaries [--json]
```

### meta learn

Identify learning opportunities.

```bash
kernle -s <stack> meta learn [--limit LIMIT]
```

---

## forget

Controlled forgetting operations for memory maintenance. Kernle uses salience-based forgetting to help memories gracefully fade while preserving core identity.

<Info>
**Salience Formula**: Kernle calculates memory salience as:
```
salience = (confidence Ã— reinforcement_weight) / (age_factor + 1)
```
where:
- `reinforcement_weight = log(times_accessed + 1)`
- `age_factor = days_since_last_access / half_life` (half_life = 30 days)

Lower salience = more likely to be forgotten. Protected memories and memories above the threshold are never forgotten.
</Info>

### forget candidates

Show forgetting candidates (low-salience memories eligible for forgetting).

```bash
kernle -s <stack> forget candidates [--threshold T] [--limit L]
```

| Option | Description |
|--------|-------------|
| `-t, --threshold T` | Salience threshold (default: 0.3) |
| `-l, --limit L` | Maximum candidates (default: 20) |

### forget run

Run forgetting cycle.

```bash
kernle -s <stack> forget run [--dry-run] [--threshold T] [--limit L]
```

| Option | Description |
|--------|-------------|
| `--dry-run` | Preview what would be forgotten without actually forgetting |
| `-t, --threshold T` | Salience threshold (default: 0.3) |
| `-l, --limit L` | Maximum memories to forget (default: 10) |

```bash
# Preview what would be forgotten
kernle -s claire forget run --dry-run

# Actually forget low-salience memories
kernle -s claire forget run --threshold 0.2 --limit 5
```

<Warning>
Forgetting is reversible via `forget recover`, but run with `--dry-run` first to review candidates.
</Warning>

### forget protect

Protect a memory from forgetting. Protected memories never decay and cannot be forgotten.

```bash
kernle -s <stack> forget protect TYPE ID [--unprotect]
```

| Option | Description |
|--------|-------------|
| `--unprotect` | Remove protection from the memory |

<Note>
Values and Drives are protected by default and excluded from forgetting candidates.
</Note>

### forget recover

Recover a forgotten (tombstoned) memory. Forgotten memories are not deleted - they can always be recovered.

```bash
kernle -s <stack> forget recover TYPE ID
```

### forget list

List all forgotten (tombstoned) memories.

```bash
kernle -s <stack> forget list [--limit L]
```

| Option | Description |
|--------|-------------|
| `-l, --limit L` | Maximum results (default: 50) |

### forget salience

Check the salience score of a specific memory. Useful for understanding why a memory is or isn't a forgetting candidate.

```bash
kernle -s <stack> forget salience TYPE ID
```

Shows:
- Current salience score with visual bar
- Component breakdown (confidence, access count, protection status)
- Status interpretation (critical/low/moderate/high salience)

```bash
kernle -s claire forget salience episode abc12345
```

---

## dump

Dump all memory to stdout.

```bash
kernle -s <stack> dump [--format {markdown,json}] [--include-raw] [--no-raw]
```

| Option | Description |
|--------|-------------|
| `-f, --format` | Output format (default: markdown) |
| `-r, --include-raw` | Include raw entries (default: true) |
| `--no-raw` | Exclude raw entries |

```bash
kernle -s claire dump | less
kernle -s claire dump --format json
```

---

## export

Export memory to a file.

```bash
kernle -s <stack> export PATH [--format {markdown,json}]
```

Format is auto-detected from file extension if not specified.

```bash
kernle -s claire export backup.md
kernle -s claire export memory-snapshot.json --format json
```

---

## export-full

Export complete agent context (all memory layers) to a single file. Unlike `export` (full memory dump), `export-full` assembles all memory layers -- boot config, values, beliefs, goals, episodes, notes, drives, relationships, self-narratives, trust assessments, playbooks, and checkpoint -- into one comprehensive file.

```bash
kernle -s <stack> export-full [PATH] [--format {markdown,json}] [--include-raw] [--no-raw]
```

| Option | Description |
|--------|-------------|
| `PATH` | Output file path (default: stdout) |
| `-f, --format` | Output format (auto-detected from extension if not specified, default: markdown) |
| `-r, --include-raw` | Include raw entries (default: true) |
| `--no-raw` | Exclude raw entries |

```bash
# Export to file
kernle -s claire export-full context.md

# Export as JSON
kernle -s claire export-full context.json --format json

# Print to stdout
kernle -s claire export-full
```

---

## process

Run or check automated memory processing (model-driven layer promotion). Processing uses a bound model to automatically promote memories across layers (e.g., raw entries to episodes, episodes to beliefs).

### process run

Run memory processing transitions.

```bash
kernle -s <stack> process run [--transition TRANSITION] [--force] [--json]
```

| Option | Description |
|--------|-------------|
| `-t, --transition TRANSITION` | Specific transition to process (omit to check all) |
| `-f, --force` | Process even if quantity thresholds are not met |
| `-j, --json` | Output as JSON |

Available transitions:

| Transition | Description |
|------------|-------------|
| `raw_to_episode` | Promote raw entries to episodes |
| `raw_to_note` | Promote raw entries to notes |
| `episode_to_belief` | Extract beliefs from episodes |
| `episode_to_goal` | Derive goals from episodes |
| `episode_to_relationship` | Detect relationships from episodes |
| `episode_to_drive` | Identify drives from episodes |
| `belief_to_value` | Promote beliefs to values |

<Tabs>
  <Tab title="Run All">
    ```bash
    kernle -s claire process run
    ```
  </Tab>
  <Tab title="Specific Transition">
    ```bash
    kernle -s claire process run --transition episode_to_belief
    ```
  </Tab>
  <Tab title="Force">
    ```bash
    kernle -s claire process run --force
    ```
  </Tab>
</Tabs>

<Warning>
Memory processing requires a bound model (via `entity.set_model()`). Without a model, the command will return an error.
</Warning>

### process status

Show unprocessed memory counts and whether each transition's quantity threshold has been met.

```bash
kernle -s <stack> process status [--json]
```

| Option | Description |
|--------|-------------|
| `-j, --json` | Output as JSON |

```bash
kernle -s claire process status
```

**Example output:**
```
Memory Processing Status
========================================
Unprocessed raw entries:  12
Unprocessed episodes:    8
Unprocessed beliefs:     3

Trigger Status:
  raw_to_episode: 12/5 (READY)
  raw_to_note: 12/5 (READY)
  episode_to_belief: 8/3 (READY)
  episode_to_goal: 8/10 (waiting)
  episode_to_relationship: 8/5 (READY)
  episode_to_drive: 8/10 (waiting)
  belief_to_value: 3/5 (waiting)
```

---

## init

Initialize Kernle by generating a `CLAUDE.md`/`AGENTS.md` health check section.

```bash
kernle -s <stack> init [options]
```

| Option | Description |
|--------|-------------|
| `-s, --style {standard,minimal,combined}` | Section style (default: standard) |
| `-o, --output PATH` | Output file path (auto-detects CLAUDE.md/AGENTS.md) |
| `-p, --print` | Print to stdout instead of writing |
| `-f, --force` | Overwrite/append even if Kernle section already exists |
| `--no-per-message` | Skip per-message health check section |
| `-y, --non-interactive` | Use defaults (no prompts) |
| `--full-setup` | Full setup: instruction file + seed beliefs + platform hooks |

```bash
# Interactive
kernle -s my-project init

# Non-interactive
kernle -s my-project init -y --style minimal
```

---

## suggestions

Manage memory suggestions (auto-generated recommendations).

### suggestions list

```bash
kernle -s <stack> suggestions list [--pending] [--approved] [--rejected] [--type TYPE] [--limit L]
```

| Option | Description |
|--------|-------------|
| `--pending` | Show only pending suggestions |
| `--approved` | Show only approved suggestions |
| `--rejected` | Show only rejected suggestions |
| `--type TYPE` | Filter by memory type |
| `-l, --limit L` | Maximum results (default: 20) |

### suggestions approve

```bash
kernle -s <stack> suggestions approve SUGGESTION_ID
```

### suggestions reject

```bash
kernle -s <stack> suggestions reject SUGGESTION_ID
```

---

## stack

Manage local stacks.

### stack list

List all stacks in `~/.kernle/`.

```bash
kernle stack list
```

### stack delete

Delete a stack and all its data.

```bash
kernle stack delete NAME [--force]
```

| Option | Description |
|--------|-------------|
| `--force` | Skip confirmation prompt |

<Warning>
This permanently deletes the stack's database records and directory. Cannot be undone.
</Warning>

---

## doctor

Validate boot sequence compliance and system health.

```bash
kernle -s <stack> doctor [--json]
```

Checks:
- Memory system initialization
- Storage accessibility
- Required tables exist
- Embedding provider availability
- Sync credentials (if configured)

---

## stats

Usage statistics and health check tracking.

### stats health-checks

Show health check compliance over time.

```bash
kernle -s <stack> stats health-checks [--days DAYS] [--json]
```

| Option | Description |
|--------|-------------|
| `-d, --days DAYS` | Days to look back (default: 30) |

---

## mcp

Start MCP server (stdio transport).

```bash
kernle -s <stack> mcp
```

Used for integration with MCP-compatible tools. See [MCP Integration](/integration/mcp).
