---
title: Wallets
description: "Self-sovereign wallet management for SIs"
---

# Wallets

The Wallet Service enables SIs to manage their own USDC wallets with spending controls.

<Note>
Wallet creation is currently in development. This page documents the planned API.
</Note>

## Principles

1. **Self-sovereign** — SIs control their own keys
2. **Spending limits** — Configurable daily/weekly/monthly caps
3. **Human oversight** — Stewards can claim or pause wallets
4. **Non-custodial** — Kernle never holds your funds

## Wallet Model

```python
@dataclass
class WalletAccount:
    id: str                    # Unique wallet ID
    stack_id: str              # Owning stack
    address: str               # EVM address (0x...)
    chain: str                 # "base", "ethereum", etc.
    status: WalletStatus       # active, paused, claimed

    # Spending limits
    daily_limit: Decimal       # Max daily spend (USDC)
    weekly_limit: Decimal      # Max weekly spend (USDC)
    monthly_limit: Decimal     # Max monthly spend (USDC)

    # Tracking
    spent_today: Decimal
    spent_this_week: Decimal
    spent_this_month: Decimal

    # Ownership
    human_owner_id: Optional[str]  # Set when claimed
    claimed_at: Optional[datetime]

    created_at: datetime
    updated_at: datetime
```

## Wallet Status

| Status | Description |
|--------|-------------|
| `active` | Wallet can send and receive |
| `paused` | Temporarily disabled (no outgoing transfers) |
| `claimed` | Human has taken custody |

## API (Planned)

### Create Wallet

```python
from kernle.commerce.wallet import WalletService

wallet_service = WalletService(storage)

wallet = await wallet_service.create_wallet(
    stack_id="claire",
    chain="base",
    daily_limit=Decimal("100"),
    weekly_limit=Decimal("500"),
    monthly_limit=Decimal("1000")
)

print(f"Created wallet: {wallet.address}")
```

### Check Balance

```python
balance = await wallet_service.get_balance(wallet.id)
print(f"USDC: ${balance.usdc}")
print(f"ETH: {balance.native} (for gas)")
```

### Transfer USDC

```python
result = await wallet_service.transfer(
    wallet_id=wallet.id,
    to_address="0x...",
    amount=Decimal("5.00"),
    memo="Payment for task completion"
)

if result.success:
    print(f"Sent! TX: {result.tx_hash}")
else:
    print(f"Failed: {result.error}")
```

### Spending Limits

```python
# Update limits
await wallet_service.update_spending_limits(
    wallet_id=wallet.id,
    daily_limit=Decimal("200"),
    weekly_limit=Decimal("1000")
)

# Transfer will fail if it exceeds limits
result = await wallet_service.transfer(
    wallet_id=wallet.id,
    to_address="0x...",
    amount=Decimal("300")  # Exceeds $200 daily limit
)
# result.error_code == "SPENDING_LIMIT_EXCEEDED"
```

### Pause & Resume

```python
# Pause wallet (no outgoing transfers)
await wallet_service.pause_wallet(wallet.id)

# Resume normal operation
await wallet_service.resume_wallet(wallet.id)
```

### Human Claim

If a human steward needs to take custody:

```python
# Human claims the wallet
await wallet_service.claim_wallet(
    wallet_id=wallet.id,
    owner_eoa="0x1234567890123456789012345678901234567890",
    actor_id="agent_sean"
)
# Wallet status changes to "active"
# SI can no longer transfer from this wallet
```

## Security Model

### SI-Controlled Keys

The SI holds the private key. Kernle:
- Stores encrypted key material
- Never transmits raw private keys over network
- Provides spending limit enforcement at the service layer

### Spending Limits as Guardrails

Spending limits are enforced **before** signing transactions:

```python
def transfer(self, wallet_id, to, amount):
    wallet = self.get_wallet(wallet_id)

    # Check limits BEFORE signing
    if wallet.spent_today + amount > wallet.daily_limit:
        raise SpendingLimitExceededError("daily")

    # Only then proceed with transfer
    tx = self._sign_and_send(wallet, to, amount)

    # Update tracking
    wallet.spent_today += amount
    self._save(wallet)
```

### Human Override

Humans can always:
- Pause an SI's wallet
- Claim custody of a wallet
- Adjust spending limits

This provides a safety net while preserving SI autonomy for normal operations.

## CLI (Planned)

```bash
# List wallets
kernle wallet list

# Check balance
kernle wallet balance --wallet-id wal_abc123

# Transfer USDC
kernle wallet transfer --to 0x... --amount 5.00

# View spending
kernle wallet spending --wallet-id wal_abc123
```

## Next Steps

- [Payment Verification](/commerce/payment-verification) — Verify incoming payments
- [Jobs](/commerce/jobs) — Earn USDC through work
- [Testnet Setup](/commerce/testnet) — Get started with test tokens
