---
title: Embeddings
description: "API endpoints for embedding generation and management"
---

# Embeddings Endpoints

Endpoints for generating and managing vector embeddings for memory search.

## How Embeddings Work

Kernle converts text memories into vector embeddings for semantic search:

1. When you create a memory, its text content is embedded
2. Embeddings are stored alongside the memory
3. Search queries are embedded and compared via cosine similarity

<Info>
Embeddings are generated automatically when you create memories. These endpoints are for advanced use cases.
</Info>

---

## Generate Embedding

Generate an embedding vector for arbitrary text.

```http
POST /embeddings/generate
```

### Headers

```
Authorization: Bearer sk-your-api-key
Content-Type: application/json
```

### Request Body

```json
{
  "text": "How to debug production API issues effectively",
  "model": "default"
}
```

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `text` | string | Required | Text to embed |
| `model` | string | "default" | Embedding model to use |

### Response

```json
{
  "success": true,
  "data": {
    "embedding": [0.023, -0.156, 0.089, ...],
    "dimensions": 1536,
    "model": "text-embedding-3-small",
    "tokens_used": 12
  }
}
```

---

## Batch Generate Embeddings

Generate embeddings for multiple texts in one request.

```http
POST /embeddings/batch
```

### Headers

```
Authorization: Bearer sk-your-api-key
Content-Type: application/json
```

### Request Body

```json
{
  "texts": [
    "First piece of text to embed",
    "Second piece of text to embed",
    "Third piece of text to embed"
  ],
  "model": "default"
}
```

### Response

```json
{
  "success": true,
  "data": {
    "embeddings": [
      [0.023, -0.156, ...],
      [0.089, 0.234, ...],
      [-0.045, 0.167, ...]
    ],
    "dimensions": 1536,
    "model": "text-embedding-3-small",
    "total_tokens_used": 36
  }
}
```

---

## Re-embed Memory

Regenerate the embedding for an existing memory.

```http
POST /embeddings/reembed
```

### Headers

```
Authorization: Bearer sk-your-api-key
Content-Type: application/json
```

### Request Body

```json
{
  "agent_id": "claire",
  "memory_type": "episode",
  "memory_id": "ep_abc123"
}
```

### Response

```json
{
  "success": true,
  "data": {
    "memory_type": "episode",
    "memory_id": "ep_abc123",
    "previous_model": "text-embedding-ada-002",
    "new_model": "text-embedding-3-small",
    "reembedded_at": "2024-01-15T10:30:00Z"
  }
}
```

---

## Bulk Re-embed

Regenerate embeddings for all memories of an agent.

<Warning>
This operation can take several minutes for agents with many memories. It runs asynchronously.
</Warning>

```http
POST /embeddings/bulk-reembed
```

### Headers

```
Authorization: Bearer sk-your-api-key
Content-Type: application/json
```

### Request Body

```json
{
  "agent_id": "claire",
  "types": ["episodes", "beliefs", "notes"],
  "model": "text-embedding-3-small"
}
```

### Response

```json
{
  "success": true,
  "data": {
    "job_id": "job_xyz789",
    "status": "queued",
    "estimated_memories": 156,
    "estimated_time_seconds": 45
  }
}
```

### Check Job Status

```http
GET /embeddings/jobs/{job_id}
```

```json
{
  "success": true,
  "data": {
    "job_id": "job_xyz789",
    "status": "completed",
    "memories_processed": 156,
    "started_at": "2024-01-15T10:30:00Z",
    "completed_at": "2024-01-15T10:30:45Z"
  }
}
```

---

## Embedding Models

| Model | Dimensions | Quality | Speed | Cost |
|-------|------------|---------|-------|------|
| `text-embedding-3-small` | 1536 | Good | Fast | Low |
| `text-embedding-3-large` | 3072 | Best | Medium | Medium |
| `text-embedding-ada-002` | 1536 | Good | Fast | Low |

Default model: `text-embedding-3-small`

---

## Similarity Search

Find memories similar to a given embedding vector.

```http
POST /embeddings/similar
```

### Request Body

```json
{
  "agent_id": "claire",
  "embedding": [0.023, -0.156, 0.089, ...],
  "limit": 10,
  "min_score": 0.7,
  "types": ["episodes", "beliefs"]
}
```

### Response

```json
{
  "success": true,
  "data": {
    "results": [
      {
        "type": "episode",
        "id": "ep_abc123",
        "score": 0.94,
        "content": { ... }
      }
    ]
  }
}
```

<Tip>
For most use cases, use the `/search` endpoint instead â€” it handles embedding generation automatically.
</Tip>

---

## Local Embeddings

For local-only usage without the cloud API, Kernle can generate embeddings locally using:

- **sqlite-vec**: Fast local vector search
- **Sentence Transformers**: Local embedding models (optional)

Configure local embeddings in `~/.kernle/config.json`:

```json
{
  "embeddings": {
    "provider": "local",
    "model": "all-MiniLM-L6-v2"
  }
}
```
